repositories:
  - name: opensearch
    url: https://opensearch-project.github.io/helm-charts
  - name: longhorn
    url: https://charts.longhorn.io

hooks:
  - events: ["prepare"]
    showlogs: true
    command: bash
    args:
      - -c
      - |
        if ! kubectl -n opensearch get secret opensearch-admin-secret >/dev/null 2>&1; then
          echo "Missing secret: opensearch-admin-secret" >&2
          exit 1
        fi

releases:
  - name: longhorn
    namespace: longhorn-system
    chart: longhorn/longhorn
    createNamespace: true

    values:
      - defaultSettings:
          defaultReplicaCount: 2  
          defaultDataPath: /var/lib/longhorn  
          defaultLonghornStaticStorageClass: longhorn
        persistence:
          defaultClass: true
          defaultClassReplicaCount: 2
  
  - name: opensearch
    namespace: opensearch
    chart: opensearch/opensearch
    values:
      - values/opensearch-values.yaml

  - name: opensearch-dashboards
    namespace: opensearch
    chart: opensearch/opensearch-dashboards
    values:
      - values/dashboard-values.yaml